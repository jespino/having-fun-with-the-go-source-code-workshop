<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercise 1: Compiling Go Without Changes - Go Source Code Workshop</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            hljs.highlightAll();

            
            document.querySelectorAll('pre').forEach(function(pre) {
                const button = document.createElement('button');
                button.className = 'copy-button';
                button.innerHTML = '<i class="far fa-copy"></i>';
                button.title = 'Copy to clipboard';

                button.addEventListener('click', function() {
                    const code = pre.querySelector('code');
                    const text = code.textContent;

                    navigator.clipboard.writeText(text).then(function() {
                        button.innerHTML = '<i class="fas fa-check"></i>';
                        button.classList.add('copied');
                        setTimeout(function() {
                            button.innerHTML = '<i class="far fa-copy"></i>';
                            button.classList.remove('copied');
                        }, 2000);
                    }).catch(function(err) {
                        console.error('Failed to copy:', err);
                    });
                });

                pre.appendChild(button);
            });
        });
    </script>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <a href="index.html" class="nav-home">ğŸš€ Having fun with the Go Source Code</a>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="https://github.com/jespino/having-fun-with-the-go-source-code-workshop" target="_blank"><i class="fab fa-github"></i> Repository</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <article class="exercise-content">
            <h1>ğŸ”¨ Exercise 1: Compiling Go Without Changes</h1>

<p>In this exercise, you&rsquo;ll learn how to build the Go toolchain from the source code without making any modifications. This is an essential skill before we start making changes to the language! âš¡</p>

<h2>ğŸ¯ Learning Objectives</h2>

<p>By the end of this exercise, you will:</p>

<ul>
<li>âœ… Understand the Go build process and bootstrap concept</li>
<li>âœ… Successfully compile Go from source</li>
<li>âœ… Know how to explore Go source code structure</li>
<li>âœ… Know how to test your custom Go build</li>
</ul>

<h2>ğŸ¥¾ Step 1: Understanding the Bootstrap Process</h2>

<p>Go is written in Go itself! ğŸ¤” This creates a &ldquo;chicken and egg&rdquo; problem - how do you compile Go without having Go? The solution is bootstrapping:</p>

<ol>
<li>ğŸ“¦ The Go team provides pre-compiled binaries</li>
<li>ğŸ”¨ These binaries compile the current Go source code</li>
<li>âœ¨ The newly compiled version can then be used for development</li>
</ol>

<p>Let&rsquo;s check if you have Go installed (needed for bootstrapping): ğŸ”</p>

<pre><code class="language-bash">go version
# Must show version 1.24.6 or newer
</code></pre>

<p><strong>âš ï¸ Critical</strong>: You must have Go 1.24.6 or newer installed to build Go 1.25.1. If you don&rsquo;t have Go installed or your version is too old, install the latest version from <a href="https://golang.org/dl/">https://golang.org/dl/</a> ğŸ“¥</p>

<h2>ğŸ“‚ Step 2: Navigate to the Go Source Directory</h2>

<pre><code class="language-bash">cd go/src
pwd
# Should show: /path/to/workshop/go/src

# Verify you're on the correct Go version
git describe --tags
# Should show: go1.25.1
</code></pre>

<h2>ğŸš€ Step 3: Start the Build Process</h2>

<p>Go provides different scripts for building. Let&rsquo;s start with <code>make.bash</code> which builds the toolchain, then explore the source code while it&rsquo;s running! âš¡</p>

<p><strong>On Unix-like systems (Linux, macOS):</strong></p>

<pre><code class="language-bash">./make.bash
</code></pre>

<p><strong>On Windows:</strong></p>

<pre><code class="language-cmd">make.bat
</code></pre>

<p>This script will: ğŸ“‹</p>

<ol>
<li>ğŸ”¨ Build the Go toolchain (compiler, linker, runtime, standard library)</li>
<li>â±ï¸ Take approximately 2-10 minutes depending on your system</li>
</ol>

<p><strong>ğŸ“ Note:</strong> The first time you run this, it will take longer as it needs to compile everything from scratch.</p>

<h3>ğŸ¤” What about <code>all.bash</code> and <code>run.bash</code>?</h3>

<p>You might wonder about other scripts in the <code>src/</code> directory:</p>

<ul>
<li><strong>ğŸ”¨ <code>make.bash</code></strong>: Builds the Go toolchain only (what we&rsquo;re using)</li>
<li><strong>ğŸ§ª <code>run.bash</code></strong>: Runs the comprehensive test suite (requires Go to be built first)<br />
</li>
<li><strong>ğŸ“¦ <code>all.bash</code></strong>: Convenience script that runs <code>make.bash</code> + <code>run.bash</code> + prints build info</li>
</ul>

<p>For this workshop, <code>make.bash</code> is perfect because:</p>

<ul>
<li>âœ… Faster build time means less waiting</li>
<li>âœ… We just need a working Go build for our experiments</li>
<li>âœ… We can run tests later if needed with <code>run.bash</code></li>
</ul>

<h2>ğŸ” Step 4: Explore Source Code While Building</h2>

<p>While the build is running, open a <strong>new terminal</strong> or <strong>IDE</strong> and let&rsquo;s explore the Go source code structure! This is a great time to understand what we&rsquo;re building. ğŸ§­</p>

<p><strong>In your new terminal:</strong></p>

<pre><code class="language-bash">cd /path/to/workshop/go  # Navigate to your Go source directory
ls -la
</code></pre>

<h3>ğŸ“ Repository Structure</h3>

<p>Key directories you should see:</p>

<ul>
<li><strong>ğŸ“ <code>src/</code></strong>: Contains the Go source code

<ul>
<li>ğŸ› ï¸ <code>src/cmd/</code>: Command-line tools (go, gofmt, etc.)</li>
<li>âš™ï¸ <code>src/runtime/</code>: Go runtime system</li>
<li>ğŸŒ³ <code>src/go/</code>: Go language packages (parser, AST, etc.)</li>
</ul></li>
<li><strong>ğŸ§ª <code>test/</code></strong>: Test files for the Go language</li>
<li><strong>ğŸ“‹ <code>api/</code></strong>: API compatibility data</li>
<li><strong>ğŸ“š <code>doc/</code></strong>: Documentation</li>
</ul>

<h3>ğŸ—ï¸ Examine the Go Compiler Structure</h3>

<p>The Go compiler is located in <code>src/cmd/compile/</code>. Let&rsquo;s explore it: ğŸ”§</p>

<pre><code class="language-bash">cd src/cmd/compile
ls -la
</code></pre>

<p>Key files and directories:</p>

<ul>
<li><strong>ğŸšª <code>main.go</code></strong>: Entry point of the compiler</li>
<li><strong>ğŸ“¦ <code>internal/</code></strong>: Internal compiler packages

<ul>
<li>ğŸ”¤ <code>internal/syntax/</code>: Lexer/parser (scanner, parser)</li>
<li>âœ… <code>internal/types2/</code>: Type checker</li>
<li>ğŸ”„ <code>internal/ir/</code>: Intermediate representation</li>
<li>âš¡ <code>internal/gc/</code>: Code generation</li>
</ul></li>
</ul>

<h2>ğŸ“Š Step 5: Understanding the Build Output</h2>

<p><strong>Switch back to your original terminal</strong> where the build is running. As the build progresses, you should see output like: ğŸ‘€</p>

<pre><code>Building Go cmd/dist using /usr/local/go. (go1.25.1 darwin/amd64)
Building Go toolchain1 using /usr/local/go.
Building Go bootstrap cmd/go (go_bootstrap) using Go toolchain1.
Building Go toolchain2 using go_bootstrap and Go toolchain1.
Building Go toolchain3 using go_bootstrap and Go toolchain2.
Building packages and commands for darwin/amd64.
</code></pre>

<p>This shows the multi-stage bootstrap process:</p>

<ul>
<li>The compiler is build with the go version installed in your system (toolchain1)</li>
<li>Then the compiler is built again using the toolchain1 to produce the toolchain2</li>
<li>Finally the toolchain3 is generated using the toolchain2.</li>
<li>The toolchain3 and toolchain2 should be identical</li>
</ul>

<h2>ğŸ“ Step 6: Locate Your Compiled Go Binary</h2>

<p>After successful compilation, your new Go binary will be in: ğŸ¯</p>

<pre><code class="language-bash">ls -la /path/to/workshop/go/bin
</code></pre>

<p>You should see:</p>

<ul>
<li>ğŸš€ <code>go</code> - The main Go command</li>
<li>ğŸ¨ <code>gofmt</code> - Go formatter</li>
<li>ğŸ› ï¸ Other Go tools</li>
</ul>

<h2>ğŸ§ª Step 7: Test Your Custom Go Build</h2>

<p>Let&rsquo;s test your newly compiled Go: âœ¨</p>

<pre><code class="language-bash"># Check version of your compiled Go
../bin/go version
</code></pre>

<p>Create a hello.go in the a temporary directory, for example <code>/tmp</code>.</p>

<pre><code class="language-go">package main

import &quot;fmt&quot;

func main() {
    fmt.Println(&quot;Hello from my custom Go build!&quot;)
}
</code></pre>

<pre><code class="language-bash"># Compile and run with your custom Go
/path/to/workshop/go/bin/go run /tmp/hello.go
</code></pre>

<h2>ğŸ“ What We Learned</h2>

<ul>
<li>ğŸ¥¾ <strong>Bootstrap Process</strong>: Go compiles itself using an existing Go installation</li>
<li>ğŸ—ï¸ <strong>Go Source Structure</strong>: Well-organized codebase with clear separation (cmd/, runtime/, etc.)</li>
<li>âš¡ <strong>Build Process</strong>: <code>./make.bash</code> builds everything</li>
</ul>

<h2>ğŸ‰ Next Steps</h2>

<p>Congratulations! ğŸŠ You now have a working Go toolchain built from source.</p>

<p>You can now proceed with any of the following exercises to learn about different parts of Go:</p>

<ul>
<li><a href="./02-scanner-arrow-operator.md">Exercise 2: Adding the &ldquo;=&gt;&rdquo; Arrow Operator for Goroutines</a> - Scanner modifications</li>
<li><a href="./03-parser-multiple-go.md">Exercise 3: Multiple &ldquo;go&rdquo; Keywords - Parser Enhancement</a> - Parser modifications</li>
<li><a href="./04-compiler-inlining-parameters.md">Exercise 4: Inline Parameters - Function Inlining Experiments</a> - Compiler parameters</li>
<li><a href="./05-gofmt-ast-transformation.md">Exercise 5: gofmt Transformation - &ldquo;hello&rdquo; to &ldquo;helo&rdquo;</a> - AST transformations</li>
<li><a href="./06-ssa-power-of-two-detector.md">Exercise 6: SSA Pass - Detecting Division by Powers of Two</a> - SSA compiler passes</li>
<li><a href="./07-runtime-patient-go.md">Exercise 7: Patient Go - Making Go Wait for Goroutines</a> - Runtime modifications</li>
<li><a href="./08-goroutine-sleep-detective.md">Exercise 8: Goroutine Sleep Detective - Runtime State Monitoring</a> - Scheduler monitoring</li>
<li><a href="./09-predictable-select.md">Exercise 9: Predictable Select - Removing Randomness from Go&rsquo;s Select Statement</a> - Select behavior</li>
<li><a href="./10-java-style-stack-traces.md">Exercise 10: Java-Style Stack Traces - Making Go Panics Look Familiar</a> - Error formatting</li>
</ul>

<p>Or return to the <a href="index.html">main workshop</a> to choose an exercise.</p>

        </article>

        <nav class="exercise-nav">
            
            <a href="00-introduction-setup.html" class="nav-button">â† Previous</a>
            
            
            <a href="02-scanner-arrow-operator.html" class="nav-button">Next: Exercise 2 â†’</a>
            
        </nav>
    </div>

    <footer>
        <div class="container">
            <p>ğŸš€ Having fun with the Go Source Code</p>
            <p>Created by <strong>JesÃºs Espino</strong></p>
            <div class="footer-links">
                <a href="https://github.com/jespino" target="_blank"><i class="fab fa-github"></i> GitHub</a>
                <a href="https://x.com/jespinog" target="_blank"><i class="fab fa-x-twitter"></i> @jespinog</a>
                <a href="https://linkedin.com/in/jesus-espino" target="_blank"><i class="fab fa-linkedin"></i> LinkedIn</a>
            </div>
        </div>
    </footer>
</body>
</html>
